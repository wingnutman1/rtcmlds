

@{
    ViewBag.Title = "My Completed Task List";
}

<p class="dataHeader">My Completed Task List</p>


@(Html.Kendo().Notification()
    .Name("popupNotification")
)
  

@using (Html.BeginForm())
{

    <div id="vertical">
        <div id="top-pane">
            <div id="horizontal" style="height: 100%; width: 100%;">
                <div id="left-pane">
                        @(Html.Kendo().Grid<CMS_Web.Models.ToDoListItem>()    
                            .Name("myToDo")
                            .Columns(columns => {
                                columns.Bound(p => p.Description).Title("Task").Width("20%");
                                columns.Bound(p => p.RelatedTo).Title("For").Width("15%");
                                columns.Bound(p => p.RequiredCompletionBy).Title("Due By").Width("15%").ClientTemplate("#= kendo.toString(kendo.parseDate(RequiredCompletionBy), 'dd/MM/yy hh:mm tt') #");
                                columns.Bound(p => p.CompletedDate).Title("Done On").Width("15%").ClientTemplate("#= kendo.toString(kendo.parseDate(CompletedDate), 'dd/MM/yy hh:mm tt') #");
                                columns.Bound(p => p.CompletedNote).Title("Completion Note").Width("35%");                                
                            })
                                    .Pageable()
                                    .Sortable()
                                    .Scrollable()      
                                    .Filterable()
                                    .HtmlAttributes(new { style = "height:99%;" })
                                    .DataSource(dataSource => dataSource.Ajax()
                                        .Model(model => model.Id(p => p.ID))
                                        .Read(read => read.Action("getMyCompleteToDoList", "ToDo"))
                                        .Sort(sort => sort.Add("CompletedDate").Descending())
                                        
                                    )
                                    .Resizable(resize => resize.Columns(true))                                    
                                )
                </div>
            </div>
        </div>
         <div id="bottom-pane">
            <div class="pane-content">
                    
                 <p class="summaryHeader">News</p>

                 This is the news.  Standby for breaking stories...                       
                
            </div>
        </div>
    </div>
    
    @(Html.Kendo().Window()
    .Name("notificationWindow")
    .Visible(false)
    )

}




 

    <style scoped>
        #vertical {
            height: 600px;
            width: 1000px;
            margin: 0 auto;
        }

        .rootfolder { background-position: 0 0; }
        .folder { background-position: 0 -16px; }
        .pdf { background-position: 0 -32px; }
        .html { background-position: 0 -48px; }
        .image { background-position: 0 -64px; }
       
        #middle-pane { background-color: rgba(60, 70, 80, 0.10); }
        #bottom-pane { 
            background-color: rgba(60, 70, 80, 0.15);
            overflow: hidden;
            }
        #left-pane, #center-pane, #right-pane  { background-color: rgba(60, 70, 80, 0.05); }

        .pane-content {
            padding: 10px 10px;
        }


    </style>
}
     
 <!--Reference the jQuery library. -->
    @*<script src="/Scripts/jquery-1.8.2.min.js" ></script>*@
    <!--Reference the SignalR library. -->
    <script src="/Scripts/jquery.signalR-2.1.2.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="/signalr/hubs"></script>





@section Scripts {

    <script type="text/x-kendo-tmpl" id="template">
        <div class="listViewFormat">
                #= Name#  
        </div>
    </script>


    @*@Scripts.Render("~/bundles/jqueryval")*@
    @Scripts.Render("~/Scripts/jquery.unobtrusive-ajax.min.js")
   

}



    <script type="text/javascript">

  $(document).ready(function () {


        var messageHub = $.connection.messageHub;
        var userName = "@HttpContext.Current.User.Identity.Name";

        $.connection.hub.qs = { 'userName': userName };
        var popupNotification = $("#popupNotification").data("kendoNotification");

        if ($.connection.hub.state === $.signalR.connectionState.disconnected) {
        $.connection.hub.start().done(function () {//when the connection is ready,

        popupNotification.show("Server Connection Established");
        });
        }

        messageHub.client.send = function (message) {
        if (message.messageType == "PM")
        popupNotification.show(message.message);
        };


  });


        $("#vertical").kendoSplitter({
            orientation: "vertical",
            panes: [
                { collapsible: false, resizable: false }, // Controls parent vertical pane
                { collapsible: false, size: "100px" }, //Controls bottom pane
            ]
        });

        $("#horizontal").kendoSplitter({
            panes: [
                { collapsible: true, size: "100%" }
        ]
        });


    </script>



    



